\newpage
\section{Theoretical Analysis}
\label{sec:analysis}

In this section, the circuit shown in figure \ref{fig:rc} is analysed
theoretically, using both the mesh and the nodal methods.

%%%%%%%%%%%%%%%%%%%%%%% Mesh Method
\subsection{Mesh method}
The 4 meshes used for this method are identified in figure \ref{fig:rc}, as well as the direction chosen for the current assigned to each mesh.
Using this method the following system was obtained:
\begin{equation}
  \begin{cases}
    \left(A\right): \left(R_{1}+R_{3}+R_{4}\right)I_{A}+R_{3}I_{B}+R_{4}I_{C}=V_{a} \\
    \left(B\right): -K_{b}R_{3}I_{A}+\left(1-K_{b}R_{3}\right)I_{B}=0               \\
    \left(C\right): R_{4}I_{A}+\left(R_{4}+R_{6}+R_{7}-K_{c}\right)I_{c}=0        \\
    \left(D\right): I_{D}=-I_{d}
  \end{cases}
\end{equation}
For meshes A and C (meshes without current sources), we used Kirchhoff's Voltage Law (KVL) around each mesh (equations (A) and (C)).
For meshes B and D (meshes with current sources), we used the relations between the current of the current sources and the mesh's current (equations (B) and (D)).
Using the following equations, we can then find the currents through each resistor:
\begin{equation}
  \begin{cases}
    I_{1}=-I_{A}      \\
    I_{2}=I_{B}       \\
    I_{3}=I_{A}+I_{B} \\
    I_{4}=I_{A}+I_{C} \\
    I_{5}=I_{B}+I_{D} \\
    I_{c}=I_{C}       \\
    I_{7}=I_{C}
  \end{cases}
\end{equation}
The voltages for each node can be directly obtained using Ohm's Law.
The results obtained are written below.

\begin{table}[h]
  \centering
  \begin{tabular}{|l|r|}
    \hline
    {\bf Name} & {\bf Value [mA]} \\ \hline
    \input{../mat/opMesh_tab}
  \end{tabular}
  \caption{Mesh analysis: values obtained for mesh currents.}
  \label{tab:op1}
\end{table}

\begin{table}[h]
  \parbox{.45\linewidth}{
    \centering
    \begin{tabular}{|c|c|}
      \hline
      {\bf Name} & {\bf Value [mA]} \\ \hline
      \input{../mat/opMeshResCurrents_tab}
    \end{tabular}
    \caption{Mesh analysis: values obtained for the currents running through the resistors.}
  }
  \hfill
  \parbox{.45\linewidth}{
    \centering
    \begin{tabular}{|c|c|}
      \hline
      {\bf Name} & {\bf Value [V]} \\ \hline
      \input{../mat/opMeshResVoltages_tab}
    \end{tabular}
    \caption{Mesh analysis: values obtained for the voltage drops across resistors (in order, $R_{1}$, ..., $R_{7}$ ).}
  }
\end{table}

%%%%%%%%%%%%%%%%%%%%%%%% Nodal Method
\subsection{Nodal method}

Applying this method the system obtained was the following:
\begin{equation}
  \begin{cases}
    \left(1\right): V_{1}=V_{a}                                                                        \\
    \left(2\right): -G_{1}V_{1}+\left(G_{1}+G_{2}+G_{3}\right)V_{2}-G_{2}V_{3}-G_{3}V_{4}=0            \\
    \left(3\right): -\left(G_{2}+K_{b}\right)V_{2}+G_{2}V_{3}+K_{b}V_{4}=0                             \\
    \left(4\right): V_{4}+K_{c}G_{6}V_{6}-V{7}=0                                                       \\
    \left(5\right): K_{b}V_{2}-\left(G_{5}+K_{b}\right)V_{4} +G_{5}V_{5}=I_{d}                       \\
    \left(6\right): \left(G_{6}+G_{7}\right)V_{6}-G_{7}V_{7}=0                                         \\
    \left(7\right): -G_{3}V_{2}+\left(G_{3}+G_{4}+G_{5}\right)V_{4}-G_{5}V_{5}-G_{7}V_{6}+G_{7}V_{6}=0 \\
  \end{cases}
\end{equation}
For this method, Kirchhoff's Current Law (KCL) was applied directly for nodes $2$, $3$, $5$ and $6$ (there are no voltage sources connected to these nodes), giving us equations (2),(3),(5) and (6). Equations (1) and (4) appear directly from the voltage sources  and the voltages of the nodes which they are connected to. Finally, since the dependent voltage source is connected to 2 non-reference nodes (nodes $4$ and $7$), we were required to apply the supernode construct (equation (7)).
Using the voltages of every node, the currents and voltages for each branch can be calculated easily.

\begin{table}[h]
  \centering
  \begin{tabular}{|l|r|}
    \hline
    {\bf Name} & {\bf Value [V]} \\ \hline
    \input{../mat/opNode_tab}
  \end{tabular}
  \caption{Node analysis: values obtained for node potentials.}
  \label{tab:op2}
\end{table}

\begin{table}[h]
  \parbox{.45\linewidth}{
    \centering
    \begin{tabular}{|c|c|}
      \hline
      {\bf Name} & {\bf Value [mA]} \\ \hline
      \input{../mat/opNodeResCurrents_tab}
    \end{tabular}
    \caption{Node analysis: values obtained for the currents running through the resistors.}
  }
  \hfill
  \parbox{.45\linewidth}{
    \centering
    \begin{tabular}{|c|c|}
      \hline
      {\bf Name} & {\bf Value [V]} \\ \hline
      \input{../mat/opNodeResVoltageDrops_tab}
    \end{tabular}
    \caption{Node analysis: values obtained for the voltage drops across resistors (in order, $R_{1}$, ..., $R_{7}$ ).}
  }
\end{table}
As we can see, the results obtained are equivalent to the ones achieved through the mesh analysis method.